pipeline {
  agent any

  environment {
        //artifact deployment S3 bucket.    
        bucket = "confluence-assessments-task-4-enquizit-2022" 
        //artifact deployment bucket region          
        region = "us-east-1"  
        //artifact upload bucket region. (optional)                    
        region1 = "us-east-2" 
        //aws credentials                    
        aws_credential = "s3-profile" //aws credentials 
        // Dockerhub credentials to push and pull images. 
        DOCKERHUB_CREDENTIALS = "dockerhub"
        KUBERNETES_CREDENTIALS  = 'kubeernetes-seccret'
    }
  stages {
    stage('Build-Docker-Image') {
     steps{
      withKubeConfig([credentialsId: "${KUBERNETES_CREDENTIALS}" ,
                    caCertificate: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCVENDQWUyZ0F3SUJBZ0lJSHZ4MWhSMUdBaFl3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TXpBNU1qWXhNelF6TkRKYUZ3MHpNekE1TWpNeE16UXpOREphTUJVeApFekFSQmdOVkJBTVRDbXQxWW1WeWJtVjBaWE13Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUUNtT1owbjY3WmxEcjFRZmRWZUNud0d3RU9IeHcwdDYyOEVLZS8xTER1czNzbUtSc1g2aXlKeWxIQ3QKdDlzSk55bm8zSFkrKzRqWEVERlpGRVVpQTJWVlBkU05UZ1JPREJUV2xBWGlSbElhM0ZHMTQ1NDdJOXZhc3ZPSFpsZHVJb2Y0WVlHVGJKZElaMk0KaTlHVy9BZXNlUnAzaSs0UkphODExbkJIT0ZLVS9GTHUrWmE3dXFDdDN0a0wvTEdMTXBzQ21WL09JWDFEYURLQVYyaVV4UGhaQXJvallnYWJUQVYKQmdOVkhSRUVEakFNZ2dwcmRXSmxjbTVsZEdWek1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQW1pdGVtZDUzWQpQMjdxUlhSNFArL0lEMjJUK3QKM2d4WXY4R0FFMjJSNXZmZ1hUcWxveWZFLzdRa0Y5T3ZtRG1DMFpQRkRUR0VlTkIvYk92S2NWUlZtdkdmMVVNYwpISzh4MnU0WUwvNUVsVWlSak9hRHp1REVMQWJUdFNLYlczeHBxZE55MUJGakpBbHJRRENlcU1VcVV3UUhCYUJXCmlHdERDa0pXekY1Mm5QUllYSERld2owRVplVkFLcFhxcjNocEhrdGd6U1MxbGFPRkEzV1hpbUc0ZmJ4c29kWUEKRFFsdkFZZGdXOHVlCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K',
                    serverUrl: 'https://BF940C2362D0B0FBF08656E462353508.gr7.us-east-1.eks.amazonaws.com',
                    clusterName: 'cluster-stack',
                    namespace: 'team-cicd-controplane'
                    ]) {
      sh 'kubectl get pods'
    }
}
      }
    }
}
